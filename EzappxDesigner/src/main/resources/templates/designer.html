<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="stylesheet" type="text/css" th:href="@{/css/grapes.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/designer.css}"/>

    <script th:src="@{/js/grapes.min.js}"></script>
    <script th:src="@{/js/jquery-3.3.1.min.js}"></script>
    <script th:src="@{/js/popper.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/ezapp-plugin-toolbar.min.js}"></script>
    <script th:src="@{/js/ezapp-plugin-ajax.min.js}"></script>
    <script th:src="@{/js/ezapp-plugin-export.min.js}"></script>
    <script th:src="@{/js/ezappx-plugin-map.min.js}"></script>
    <script th:src="@{/js/ezappx-plugin-framework7.min.js}"></script>

    <title>Ezappx Designer</title>
</head>

<body>
<div id="gjs"></div>
<div id="tip"></div>

<script type="text/javascript" th:inline="javascript">
    const editor = grapesjs.init({
        height: "100%",
        showOffsets: 1,
        noticeOnUnload: 0,
        storageManager: {
            id: "gjs-",
            type: "local",
            autosave: true,
            autoload: true,
            stepBeforeSave: 1
        },
        container: "#gjs",
        fromElement: true,
        plugins: [
            "ezapp-plugin-ajax",
            "ezapp-plugin-export",
            "ezapp-plugin-toolbar",
            "ezappx-plugin-map",
            "ezappx-plugin-framework7"],
        pluginsOpts: {
            "ezapp-plugin-export": {
                tipDivId: "tip",
                username: /*[[${username}]]*/ "default-user",
                projectName: /*[[${username}]]*/ "default-project",
                uploadApi: "/upload/projectFile",
                exportApi: "/export/mobileAppProject"
            },
            "ezapp-plugin-toolbar": {
                tipDivId: "tip",
            },
            "ezappx-plugin-map": {
                tencentMapApiKey: "2VMBZ-JXJRP-A6MDS-VOUUP-7WKSH-ZNFXX"
            },
        },

        canvas: {
            styles: ["http://cdn.ezappx.com/css/framework7.min.css"],
            scripts: ["http://cdn.ezappx.com/js/jquery-3.3.1.min.js",
                "http://cdn.ezappx.com/js/framework7.min.js"],
        },

        assetManager: {
            upload: /*[[${uploadApi}]]*/ 0,
            uploadName: "files",
            params: {
                "username": /*[[${username}]]*/ "default-user",
                "projectName": /*[[${username}]]*/ "default-project"
            }
        },

        deviceManager: {
            devices: [],
        }
    });
    editor.setDevice('Android'); //TODO 应该由后台传入用户设置
    window.editor = editor;
</script>
</body>